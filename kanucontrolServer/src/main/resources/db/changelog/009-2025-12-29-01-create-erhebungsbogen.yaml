databaseChangeLog:
  - changeSet:
      id: 2025-12-29-01
      author: chris
      context: default
      changes:

        - createTable:
            tableName: erhebungsbogen
            columns:

              - column:
                  name: id
                  type: BIGINT
                  autoIncrement: true
                  constraints:
                    primaryKey: true
                    nullable: false

              # =========================
              # Bezug
              # =========================

              - column:
                  name: veranstaltung_id
                  type: BIGINT
                  constraints:
                    nullable: false
                    unique: true

              # =========================
              # Status
              # =========================

              - column:
                  name: abgeschlossen
                  type: BOOLEAN
                  defaultValueBoolean: false
                  constraints:
                    nullable: false

              - column:
                  name: stichtag
                  type: DATE
                  constraints:
                    nullable: false

              # =========================
              # Statistik – Teilnehmer
              # =========================

              - column: { name: teilnehmer_maennlich_u6,        type: INT }
              - column: { name: teilnehmer_maennlich_6_13,      type: INT }
              - column: { name: teilnehmer_maennlich_14_17,     type: INT }
              - column: { name: teilnehmer_maennlich_18_plus,   type: INT }

              - column: { name: teilnehmer_weiblich_u6,         type: INT }
              - column: { name: teilnehmer_weiblich_6_13,       type: INT }
              - column: { name: teilnehmer_weiblich_14_17,      type: INT }
              - column: { name: teilnehmer_weiblich_18_plus,    type: INT }

              - column: { name: teilnehmer_divers_u6,           type: INT }
              - column: { name: teilnehmer_divers_6_13,         type: INT }
              - column: { name: teilnehmer_divers_14_17,        type: INT }
              - column: { name: teilnehmer_divers_18_plus,      type: INT }

              # =========================
              # Statistik – Mitarbeitende
              # =========================

              - column: { name: mitarbeiter_maennlich, type: INT }
              - column: { name: mitarbeiter_weiblich,  type: INT }
              - column: { name: mitarbeiter_divers,    type: INT }

              # =========================
              # Optional
              # =========================

              - column:
                  name: bemerkung
                  type: VARCHAR(500)

              # =========================
              # Audit
              # =========================

              - column:
                  name: created_at
                  type: DATETIME
                  constraints:
                    nullable: false

              - column:
                  name: created_by
                  type: VARCHAR(100)

              - column:
                  name: last_modified_at
                  type: DATETIME

              - column:
                  name: last_modified_by
                  type: VARCHAR(100)

        - addForeignKeyConstraint:
            baseTableName: erhebungsbogen
            baseColumnNames: veranstaltung_id
            referencedTableName: veranstaltung
            referencedColumnNames: id
            constraintName: fk_erhebungsbogen_veranstaltung
            onDelete: RESTRICT