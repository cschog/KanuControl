databaseChangeLog:
  - changeSet:
      id: 003-create-mitglied
      author: chris
      changes:
        - createTable:
            tableName: mitglied
            columns:
              - column:
                  name: id
                  type: BIGINT
                  autoIncrement: true
                  constraints:
                    primaryKey: true
                    nullable: false

              - column:
                  name: person_id
                  type: BIGINT
                  constraints:
                    nullable: false

              - column:
                  name: verein_id
                  type: BIGINT
                  constraints:
                    nullable: false

              - column: { name: funktion, type: VARCHAR(100) }

              - column:
                  name: haupt_verein
                  type: BOOLEAN
                  constraints:
                    nullable: false

              - column: { name: eintrittsdatum, type: DATE }
              - column: { name: austrittsdatum, type: DATE }

              # Auditing
              - column:
                  name: created_at
                  type: TIMESTAMP
              - column:
                  name: created_by
                  type: VARCHAR(100)
              - column:
                  name: last_modified_at
                  type: TIMESTAMP
              - column:
                  name: last_modified_by
                  type: VARCHAR(100)

        - addUniqueConstraint:
            tableName: mitglied
            columnNames: person_id, verein_id
            constraintName: uk_mitglied_person_verein

        - addForeignKeyConstraint:
            baseTableName: mitglied
            baseColumnNames: person_id
            referencedTableName: person
            referencedColumnNames: id
            constraintName: fk_mitglied_person
            onDelete: CASCADE

        - addForeignKeyConstraint:
            baseTableName: mitglied
            baseColumnNames: verein_id
            referencedTableName: verein
            referencedColumnNames: id
            constraintName: fk_mitglied_verein
            onDelete: CASCADE